<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Email Manager - Settings</title>

  <!-- Montserrat Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Shared Styles -->
  <link rel="stylesheet" href="/shared/src/ui/design-tokens.css">
  <link rel="stylesheet" href="/shared/src/ui/styles.css">

  <!-- Page-Specific Styles -->
  <link rel="stylesheet" href="../styles/email-manager.css">
</head>
<body>
  <div class="email-manager">
    <!-- Left Sidebar: Template List -->
    <aside class="template-list">
      <h2>Email Templates</h2>

      <div class="template-group">
        <h3>ğŸ“§ Customer Emails</h3>
        <div id="customer-templates" class="template-items"></div>
      </div>

      <div class="template-group">
        <h3>ğŸ”” Internal Emails</h3>
        <div id="internal-templates" class="template-items"></div>
      </div>
    </aside>

    <!-- Center Panel: Template Editor -->
    <main class="template-editor">
      <div id="editor-empty" class="empty-state">
        <p>Select a template to edit</p>
      </div>

      <div id="editor-content" class="editor-content" style="display: none;">
        <div class="editor-header">
          <h1 id="template-title"></h1>
          <div class="editor-header-actions">
            <div class="editor-mode-toggle">
              <button id="simple-mode-btn" class="mode-btn active">ğŸ“ Simple</button>
              <button id="advanced-mode-btn" class="mode-btn">ğŸ’» Advanced</button>
            </div>
            <span class="template-status" id="template-status">âœ“ Active</span>
          </div>
        </div>

        <!-- Simple Editor (Form-based) -->
        <div id="simple-editor" class="editor-form">
          <label for="subject-input">Subject Line:</label>
          <input
            type="text"
            id="subject-input"
            class="subject-input"
            placeholder="Email subject with {{VARIABLES}}"
          />

          <div id="content-fields" class="content-fields">
            <!-- Dynamic content fields will be inserted here -->
          </div>

          <div class="available-variables">
            <strong>Available Variables:</strong>
            <span id="variables-list"></span>
          </div>

          <div class="editor-actions">
            <button id="save-btn" class="btn btn-primary">Save Changes</button>
            <button id="revert-btn" class="btn btn-secondary">Revert to Default</button>
          </div>
        </div>

        <!-- Advanced Editor (Raw HTML) -->
        <div id="advanced-editor" class="editor-form" style="display: none;">
          <label for="subject-input-advanced">Subject Line:</label>
          <input
            type="text"
            id="subject-input-advanced"
            class="subject-input"
            placeholder="Email subject with {{VARIABLES}}"
          />

          <label for="body-input">
            Email HTML:
            <span class="help-text">Edit raw HTML (for advanced users only)</span>
          </label>
          <textarea
            id="body-input"
            class="body-input"
            rows="20"
            placeholder="Email content with {{VARIABLES}}"
          ></textarea>

          <div class="available-variables">
            <strong>Available Variables:</strong>
            <span id="variables-list-advanced"></span>
          </div>

          <div class="editor-actions">
            <button id="save-advanced-btn" class="btn btn-primary">Save Changes</button>
            <button id="revert-advanced-btn" class="btn btn-secondary">Revert to Default</button>
          </div>
        </div>
      </div>
    </main>

    <!-- Resize Handle -->
    <div class="resize-handle" id="resize-handle"></div>

    <!-- Right Panel: Preview & Testing -->
    <aside class="preview-panel">
      <div class="preview-header">
        <h3>Preview</h3>
        <div class="preview-toggle">
          <button id="preview-mobile" class="preview-btn">ğŸ“± Mobile</button>
          <button id="preview-desktop" class="preview-btn active">ğŸ’» Desktop</button>
        </div>
      </div>

      <div class="test-data-form">
        <h4>Test Data:</h4>
        <div id="test-data-inputs"></div>
        <button id="refresh-preview" class="btn btn-small">ğŸ”„ Refresh Preview</button>
      </div>

      <div class="preview-container">
        <iframe id="preview-frame" class="preview-frame desktop"></iframe>
      </div>

      <!-- Vertical Resize Handle -->
      <div class="preview-resize-handle" id="preview-resize-handle"></div>

      <div class="test-email-form">
        <h4>Send Test Email:</h4>
        <input
          type="email"
          id="test-email-input"
          placeholder="your@email.com"
        />
        <button id="send-test-btn" class="btn btn-primary">ğŸ“§ Send Test</button>
      </div>
    </aside>
  </div>

  <script type="module" src="./email-manager.js"></script>
</body>
</html>
